Bootstrap: docker
From: ubuntu:24.04

# %files

#   Gemfile $HOME/
#   package.json $HOME/

%post
  export DEBIAN_FRONTEND=noninteractive

  apt-get update

  apt-get install -y --no-install-recommends git
  apt-get install -y --no-install-recommends gh

  apt-get install -y --no-install-recommends less

  # python
  apt-get install -y --no-install-recommends python3
  apt-get install -y --no-install-recommends python3.12-venv python3-pip

  # needed by Ruby and gems
  apt-get install -y --no-install-recommends build-essential
  apt-get install -y --no-install-recommends ruby ruby-dev
  apt-get install -y --no-install-recommends libyaml-dev
  apt-get install -y --no-install-recommends bundler

  # NodeJS
  apt-get install -y --no-install-recommends nodejs
  apt-get install -y --no-install-recommends npm

  # asciidoc-diagram dependence (asciidoc is installed as a gem outside the container)
  apt-get install -y --no-install-recommends ditaa

  # needed by cpp_hart build
  apt-get install -y --no-install-recommends cmake
  apt-get install -y --no-install-recommends g++
  apt-get install -y --no-install-recommends gdb
  apt-get install -y --no-install-recommends libgmp-dev
  apt-get install -y --no-install-recommends clang-format
  apt-get install -y --no-install-recommends clang-tidy
  apt-get install -y --no-install-recommends libelf-dev
  apt-get install -y --no-install-recommends gcc-riscv64-linux-gnu
  apt-get install -y --no-install-recommends gcc-riscv64-unknown-elf
  apt-get install -y --no-install-recommends libc6-dev-riscv64-cross

  # cleanup
  apt-get clean autoclean
  apt-get autoremove -y
  rm -rf /var/lib/{apt, dpkg, cache, log}

  # cd $HOME
  # bundle install

  # npm i wavedrom-cli
  # npm i i -E  @antora/cli@3.1 @antora/site-generator@3.1 @antora/lunr-extension asciidoctor-kroki
